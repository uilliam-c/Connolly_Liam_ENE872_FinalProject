---
title: "Spatial Hotspots and Seasonal Shifts in Juvenile Loggerhead Sea Turtle Telemetry Data (2002–2005)"
https://github.com/uilliam-c/Connolly_Liam_ENE872_FinalProject
author: "Liam Connolly"
output: bookdown::pdf_document2
  toc: false
    number_selections: true
---
\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# Load your packages
library(tidyverse)
library(lubridate)
# Set your ggplot theme
theme_set(theme_bw())
# Load your datasets
turtle_points <- readr::read_csv("../data_raw/turtlepoints.csv",
  show_col_types = FALSE)

modifiedturtle_points <- turtle_points %>%
  mutate(date_time =ymd_hms(date_time, tz = "UTC"),
  month = month(date_time), 
  season = ifelse(month %in% c(12, 1, 2), "Winter",
           ifelse(month %in% c(3, 4, 5), "Spring",
           ifelse(month %in% c(6, 7, 8), "Summer", "Fall"))),
  season = factor(season, levels = c("Winter", "Spring", "Summer", "Fall")),
  classitem = factor(classitem)) %>%
  filter(!is.na(latitude), !is.na(longitude), !is.na(date_time))
modifiedturtle_points <- modifiedturtle_points %>%
  mutate(lon_wrap = ifelse(longitude > 180, longitude - 360, longitude))
```


# 1. Rationale
According to the online database, from which I collected my data, juvenile 
loggerhead turtles (Caretta caretta) move around frequently. Due to their 
juvenile phase of life, they are highly mobile yet, what isn't known is how or 
why they move to certain places in different seasons or ocean regions. 
From a spatial perspective, we don't have answers. Being able to identify where 
and when these turtles move/are found can help better understand their habitats.
It would be awesome to discover "hotspots" of more concentrated turtle presence 
as that may guide additional ecological analyses in the future. With the data 
available, it should be possible to assemble a general sense of the spatial 
patterns these loggerheads exhibit.

The background of this dataset relies on using satellite tracking locations
where each record present is indicative of a geo-referenced observation of a 
juvenile loggerhead. Each record comes with latitude/longitude, an individual 
identifier (series_id), and a timestamp (date_time). It is likely the dataset
will include repeated observations from the same loggerhead over the course of
the study (2002-2005), the data is still relevant for basic analyses. I will be 
focusing on examing seasonal distribution and spatial concentration for the 
loggerheads. Finally, the data contains a location "class" code (classitem) and 
some precision fields to help evaluate the patterns of data quality. 

# 2. Research Questions
Research Topic 1) Seasonal distribution Shifts
Research Question: Do juvenile loggerhead sea turtle locations (latitude)
differ among seasons (Winter, Spring, Summer, Fall)?
Hypothesis: Mean latitude differs among seasons.
Rationale for hypothesis: By nature, seasonal changes in ocean conditions such 
as temperature, current direction, etc should influence where juvenile turtles 
are found. If this were true that juvenile loggerheads go to different places
throughout the year, or if observation density varies by the different seasons
in varying areas, then there should be differences in latitude 
among seasons.

Research Topic 2) Spatial Hotspots of Presence
Research Question : Are loggerhead turtles locations concentrated in a few 
specific geographic areas (“Hotspots”) or are they more evenly distributed?
Hypothesis: The locations are spatially clustered, with a small amount of 
places accounting for a disproportionate amount of loggerhead observations.
Rationale: It isn't uncommon for animals, when they find a favorable place to 
live with good food availability or water temperature, to appear repeatedly in 
the same area. Therefore, if I can discover repeated observations of 
loggerheads in the same types of areas, it should allow for the creation of 
measurable hotspots in a spatial setting.

Research Topic 3) Data quality Differences by Location Class
Research Question: Do the categories in classitem correspond with 
differences in reported location precision (lprecision), and what would that
imply for interpreting spatial patterns?
Hypothesis: At least one classitem category has a different mean/median 
lprecision than the others
Rationale: While examining the dataset, I came across the columns with largely
unexplained categorical code (I think its categorical) that wasn't mentioned
anywhere in the public database. Those codes being classitem, and precision 
fields lprecision andtprecision. Upon consulting the metadata, it didn't 
mention what those fields meant either. Precision would naturally be relevant 
to examining hotspots as positioning would impact spatial clustering so I 
am curious if precision differs across classitem categories.  
\newpage

# 3. Dataset Information
This dataset originates from OBIS-SEAMAP. Specifically, the dataset is called
“SWFSC juvenile loggerhead sea turtle tracking 2002–2005” 
(Dataset ID 758; Version 1.0.1; internal DOI: 10.82144/4774e438). Actual URL is:
https://seamap.env.duke.edu/dataset/758
The metadata explains in further detail that the source is satellite tracking 
data of the juvenile loggerhead turtle (Caretta caretta). The dataset has data 
from October 14, 2002 to July 7, 2005. Location coordinates are provided in 
decimal degrees (coordinate system: WGS84), and the spatial extent 
for the dataset is approximately 20.95–41.913° N latitude and 
153.571–246.713° E longitude. 

Each row in the points file is a single location observation for an 
individually separate turtle. Also included with an observation is the latitude
and longitude (represented in decimal degrees) and observation date/time. There
are some limitations as publically downloading the data limits me to core fields
including date/time, latitude/longitude, and species information. It is unclear
if the categories I can't download will influence the data analyses I conduct. 
\newpage

# 4. Data Wrangling
I imported the points CSV into R-studio Online and converted the 
date_time column to date_time in UTC. I removed any records with missing
latitude, longitude, or timestamp information. In this case, just one record was
removed. Not knowing this in advance that only one record would be removed,
I intended to ensure all analyses had a complete set of spatial observations
recorded to remove outlier data. Additionally, I created a categorical season 
variable from the months included in date_time. Winter was defined as Dec–Feb,
Spring = Mar–May, Summer = Jun–Aug, and Fall = Sep–Nov. Finally, I converted
class_item to a categorical variable for later group comparison.

```{r}
table1 <- tibble::tibble(
  Detail = c("Data source",
             "Retrieved from",
             "Dataset title",
             "Dataset ID",
             "DOI",
             "Date range",
             "Coordinate system"),
  Description = c("OBIS-SEAMAP",
                  "https://seamap.env.duke.edu/dataset/758",
                  "SWFSC juvenile loggerhead sea turtle tracking 2002–2005",
                  "758",
                  "https://doi.org/10.82144/4774e438",
                  "2002-10-14 to 2005-07-07",
                  "WGS84; decimal degrees")
)

knitr::kable(table1, caption = "Dataset information.")

table2_vertical <- tibble::tibble(
  Detail = c("Number of observations", "Number of turtles", "Start date-time", 
          "End date-time", "Minimum latitude", "Maximum latitude", 
          "Minimum longitude", "Maximum longitude", "Median lprecision"),
  Value = c(nrow(modifiedturtle_points),
            dplyr::n_distinct(modifiedturtle_points$series_id),
            as.character(min(modifiedturtle_points$date_time, na.rm = TRUE)),
            as.character(max(modifiedturtle_points$date_time, na.rm = TRUE)),
            min(modifiedturtle_points$latitude, na.rm = TRUE),
            max(modifiedturtle_points$latitude, na.rm = TRUE),
            min(modifiedturtle_points$longitude, na.rm = TRUE),
            max(modifiedturtle_points$longitude, na.rm = TRUE),
            median(modifiedturtle_points$lprecision, na.rm = TRUE))
)

knitr::kable(table2_vertical, caption = "Data structure and 
Basic ranges for Key Variables Used.")

```
\newpage

# 5. Exploratory Analysis 
This analysis of the data used gives a general summary of the spatial
structure of the juvenile loggerhead turtle location dataset prior to testing
my three hypotheses. First, I use maps of latitude and longitude to describe
the geographic extent of observations and then I try to do a summary
over time to get a sense of the patterns of observation across months and
seasons. To inquire the spatial concentration for question 2, I tried to express
a visualization of point density to identify whether sightings appear
clustered into potential “hotspots.” Additionally, I was curious to see if I
could separate the observations between individual turtles (via series_id) to
find repeated sightings. Finally, I try to express latitude by season
(Winter, Spring, Summer, Fall) to address the seasonal questions from the first
question and to compare the reported location precision (lprecision) with
classitem categories. This is to determine if the differences in positional 
precision could influence the spatial clustering that I was curious of in my
third research question.
```{r}
missingdata_table <- modifiedturtle_points %>%
  summarise(
    n_total = n(),
    missing_lat = sum(is.na(latitude)),
    missing_lon = sum(is.na(longitude)),
    missing_date_time = sum(is.na(date_time)),
    missing_lprecision = sum(is.na(lprecision)),
    missing_classitem = sum(is.na(classitem))
  ) %>%
  mutate(across(everything(), as.character)) %>%
  tidyr::pivot_longer(everything(), names_to = "Detail", values_to = "Value")
knitr::kable(missingdata_table, caption = "Representing Missing Data 
             with Key Variables.")
```
This table shows, after filtering, that there are no missing values within the 
key variables used for analysis (latitude, longitude, timestamp, precision, 
and class code). With this in mind, further plots and tests are being conducted
off a complete dataset of 6861 location observations.
```{r map, fig.cap="Spatial Patterns for Turtles.", fig.width=7, fig.height=4, out.width="0.9\\linewidth", fig.align="center"}
ggplot(modifiedturtle_points, aes(x = lon_wrap, y = latitude)) +
  geom_point(alpha = 0.3) +
  labs(x = "Longitude", y = "Latitude")
```
Figure shows the geographic extent of juvenile loggerhead turtle
locations within this dataset. 

```{r time, fig.cap="Number of location observations over time (by month)."}
time_counts <- modifiedturtle_points %>%
  mutate(month_start = floor_date(date_time, unit = "month")) %>%
  count(month_start)
ggplot(time_counts, aes(x = month_start, y = n)) +
  geom_col() +
  scale_x_date(date_breaks = "6 months", date_labels = "%Y-%m") +
  labs(x = "Month", y = "Number of observations")
```
This Figure shows sampling intensity across the duration of the study period.

```{r time, fig.cap="Number of location observations over time (by month)."}
time_counts <- modifiedturtle_points %>%
  mutate(month_start = floor_date(date_time, unit = "month")) %>%
  count(month_start)

ggplot(time_counts, aes(x = month_start, y = n)) +
  geom_col() +
  scale_x_date(date_breaks = "6 months", date_labels = "%Y-%m") +
  labs(x = "Month", y = "Number of observations")
```
This figure shows that separate turtles provide different numbers
of observations.
\newpage

# Analysis



## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
